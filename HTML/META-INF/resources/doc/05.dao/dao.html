<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link type="text/css" href="../css/document.css" rel="stylesheet" />
		<title>DAOパッケージ</title>
	</head>
	<body>
		<h1><span>6.</span>Table,Query,Dao</h1>
		<p>
			この記事でdataforms.daoパッケージのTable,Query,Daoクラスについて解説していきます。
			Tableクラスはテータベース中のテーブルの構造を定義します。
			QueryクラスはSQLのselect文に対応するクラスです。
			複数のテーブルクラスを結合した問合せクラスを作成することができるようになっています。
			DaoクラスはTableクラスのレコード追加・更新・削除、Queryクラスで定義した問合せを実行する機能を持っています。
			dataforms.daoパッケージは複数のデータベースサーバ(Apache derby,PostgreSQL,MySQL,Oracle)に対応しています。
			各データベースのサーバのSQLには方言があり、直接データベースをアクセスする場合その文法の違いを考慮してSQLを記述する必要がありました。
			データベースの操作はJavaのクラスのみで行い、SQLを使うことはほとんどありません。
			そのため選択したデータベースに依存するコードを排除することができます。
			実際「単体テストまでは環境構築が簡単なApache derbyで作業し、結合テスト以降はPostgreSQLサーバを用意してテスト」という開発を問題なく進めた実績があります。
		</p>
		<h2>Tomcatのデータベース接続設定</h2>
		<p>
			テータベースの接続設定はTomcat等のアプリケーションサーバ側で行います。
			Tomcat9を例に設定のポイントを説明します。
		</p>
		<h3>データベースの接続設定の記述場所</h3>
		<p>
			dfblank_xxx.warをインポートしたプロジェクトでは、WebContent/META-INF/content.xmlというファイルが存在しています。
			このファイルにデータベースの接続設定が入っています。
			WebContent/META-INF/content.xmlはwarファイルの中に含まれているファイルです。
			そのためWebアプリケーションにDBへの接続設定を含めてリリースする場合に使用します。
			runwar等を使用してスタンドアロンアプリケーションのように使用する場合、
			WebContent/META-INF/content.xmlを使用します。
		</p>
		<p>
			Tomcat9ではデータベースの接続設定を$TOMCAT_HOME/conf/context.xmlにも記述することができます。
			(Eclipse上のTomcatの場合"Servers/ローカルホスト の Tomcat9 (Java11)-config/context.xml"がこれに当たります。)
			WebContent/META-INF/content.xmlデータベースの接続設定を削除し、$TOMCAT_HOME/conf/context.xmlにデータベース接続設定を移動しても同様に動作します。
			この状態で*.warファイルを作成すると、*.warファイル中に接続設定は存在しないため、Tomcatのデータベース接続設定が使用されます。
			Eclipse上のTomcatはテスト用のデータベースに接続し、本番用サーバ上のTomcatには本番用データベースに接続するように設定しておきます。
			こうしておくと、Eclipseで*.warファイルを作成し本番用サーバの$TOMCAT_HOME/webappsにコピーするだけで、本番環境へのデプロイが完了します。
		</p>
		<h3>データベース接続設定の記述内容</h3>
		<p>
			dfblank_xxx.warに入っている、META-INF/context.xmlは以下の様になっています。
		</p>
		<div class="filecaption">context.xmlの内容</div>
		<div class="wrappre">
			<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE Context&gt;&lt;Context addWebinfClassesResources=&quot;true&quot;&gt;
	&lt;!--
		&#32068;&#12415;&#36796;&#12415;Apache derby&#29992;&#12398;&#25509;&#32154;&#35373;&#23450;
		Apache derby&#12398;JDBC&#12489;&#12521;&#12452;&#12496;&#12399;&#21046;&#32004;&#21517;&#31216;&#12434;&#21462;&#24471;&#12377;&#12427;API&#12364;&#12354;&#12427;&#12383;&#12417;
		duplicateErrorMessage&#12392;foreignKeyErrorMessage&#12398;&#35373;&#23450;&#12399;&#19981;&#35201;&#12290;
	 --&gt;
	&lt;Resource auth=&quot;Container&quot;
		driverClassName=&quot;org.apache.derby.jdbc.EmbeddedDriver&quot;
		name=&quot;jdbc/dfdb&quot; type=&quot;javax.sql.DataSource&quot;
		url=&quot;jdbc:derby:/javadb/dfdbC;create=true&quot;
		username=&quot;&quot; password=&quot;&quot; /&gt;
	&lt;!--
		Apache derby&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#12469;&#12540;&#12496;&#29992;&#12398;&#25509;&#32154;&#35373;&#23450;
		Apache derby&#12398;JDBC&#12489;&#12521;&#12452;&#12496;&#12399;&#21046;&#32004;&#21517;&#31216;&#12434;&#21462;&#24471;&#12377;&#12427;API&#12364;&#12354;&#12427;&#12383;&#12417;
		duplicateErrorMessage&#12392;foreignKeyErrorMessage&#12398;&#35373;&#23450;&#12399;&#19981;&#35201;&#12290;
	--&gt;
	&lt;!--
	&lt;Resource auth=&quot;Container&quot; driverClassName=&quot;org.apache.derby.jdbc.ClientDriver&quot;
		maxActive=&quot;8&quot; maxIdle=&quot;4&quot; name=&quot;jdbc/dfdb&quot; type=&quot;javax.sql.DataSource&quot;
		url=&quot;jdbc:derby://localhost:1527/javadb/blank;create=true&quot; username=&quot;APP&quot;
		password=&quot;password&quot; /&gt;
	--&gt;

	&lt;!--
		PostgreSQL&#29992;&#12398;&#25509;&#32154;&#35373;&#23450;
		&#21046;&#32004;&#36949;&#21453;&#12398;&#22580;&#21512;&#12289;&#21046;&#32004;&#21517;&#12399;&#12456;&#12521;&#12540;&#12513;&#12483;&#12475;&#12540;&#12472;&#12363;&#12425;&#21462;&#24471;&#12377;&#12427;&#12398;&#12391;&#12289;
		&#19968;&#24847;&#21046;&#32004;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;duplicateErrorMessage&#12289;
		&#22806;&#37096;&#12461;&#12540;&#21046;&#32004;&#29992;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;foreignKeyErrorMessage&#12395;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
	 --&gt;
	&lt;!--
	&lt;Resource name=&quot;jdbc/dfdb&quot; type=&quot;javax.sql.DataSource&quot;
		auth=&quot;Container&quot; driverClassName=&quot;org.postgresql.Driver&quot;
		url=&quot;jdbc:postgresql://192.168.56.102:5432/dfdb&quot; username=&quot;postgres&quot;
		password=&quot;&quot; /&gt;
	&lt;Environment name=&quot;duplicateErrorMessage&quot; value=&quot;&#19968;&#24847;&#24615;&#21046;&#32004;&quot;(.+?)&quot;&#12395;&#36949;&#21453;&quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	&lt;Environment name=&quot;foreignKeyErrorMessage&quot; value=&quot;&#22806;&#37096;&#12461;&#12540;&#21046;&#32004;&quot;(.+?)&quot;&#12395;&#36949;&#21453;&quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	--&gt;

	&lt;!--
		MariaDB&#29992;&#25509;&#32154;&#35373;&#23450;
		MariaDB&#29992;&#12398;jdbc&#12489;&#12521;&#12452;&#12496;&#12540;&#12434;&#20351;&#29992;&#12377;&#12427;&#22580;&#21512;&#12398;&#35373;&#23450;&#12391;&#12377;&#12290;
		&#21046;&#32004;&#36949;&#21453;&#12398;&#22580;&#21512;&#12289;&#21046;&#32004;&#21517;&#12399;&#12456;&#12521;&#12540;&#12513;&#12483;&#12475;&#12540;&#12472;&#12363;&#12425;&#21462;&#24471;&#12377;&#12427;&#12398;&#12391;&#12289;
		&#19968;&#24847;&#21046;&#32004;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;duplicateErrorMessage&#12289;
		&#22806;&#37096;&#12461;&#12540;&#21046;&#32004;&#29992;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;foreignKeyErrorMessage&#12395;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
	 --&gt;
	&lt;!--
	&lt;Resource name=&quot;jdbc/dfdb&quot; auth=&quot;Container&quot; type=&quot;javax.sql.DataSource&quot;
		username=&quot;dfuser&quot; password=&quot;password&quot; driverClassName=&quot;org.mariadb.jdbc.Driver&quot;
		url=&quot;jdbc:mysql://192.168.56.102/dfdb?useOldAliasMetadataBehavior=true&quot; /&gt;
	&lt;Environment name=&quot;duplicateErrorMessage&quot; value=&quot;for key '(.+?)'$&quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	&lt;Environment name=&quot;foreignKeyErrorMessage&quot; value=&quot;CONSTRAINT `(.+?)` FOREIGN KEY&quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	--&gt;

	&lt;!--
		MySQL&#29992;&#25509;&#32154;&#35373;&#23450;
		MySQL&#29992;&#12398;jdbc&#12489;&#12521;&#12452;&#12496;&#12540;&#12434;&#20351;&#29992;&#12377;&#12427;&#22580;&#21512;&#12398;&#35373;&#23450;&#12391;&#12377;&#12290;
		&#21046;&#32004;&#36949;&#21453;&#12398;&#22580;&#21512;&#12289;&#21046;&#32004;&#21517;&#12399;&#12456;&#12521;&#12540;&#12513;&#12483;&#12475;&#12540;&#12472;&#12363;&#12425;&#21462;&#24471;&#12377;&#12427;&#12398;&#12391;&#12289;
		&#19968;&#24847;&#21046;&#32004;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;duplicateErrorMessage&#12289;
		&#22806;&#37096;&#12461;&#12540;&#21046;&#32004;&#29992;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;foreignKeyErrorMessage&#12395;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
	--&gt;
	&lt;!--
	&lt;Resource name=&quot;jdbc/dfdb&quot; auth=&quot;Container&quot; type=&quot;javax.sql.DataSource&quot;
		username=&quot;dfuser&quot; password=&quot;password&quot; driverClassName=&quot;com.mysql.jdbc.Driver&quot;
		url=&quot;jdbc:mysql://192.168.56.102/dfdb?generateSimpleParameterMetadata=true&amp;useInformationSchema=true&amp;useOldAliasMetadataBehavior=true&amp;characterEncoding=utf8&quot; /&gt;
	&lt;Environment name=&quot;duplicateErrorMessage&quot; value=&quot;for key '(.+?)'$&quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	&lt;Environment name=&quot;foreignKeyErrorMessage&quot; value=&quot;CONSTRAINT `(.+?)` FOREIGN KEY&quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	--&gt;

	&lt;!--
		ORACLE&#29992;&#12398;&#25509;&#32154;&#35373;&#23450;
		&#21046;&#32004;&#36949;&#21453;&#12398;&#22580;&#21512;&#12289;&#21046;&#32004;&#21517;&#12399;&#12456;&#12521;&#12540;&#12513;&#12483;&#12475;&#12540;&#12472;&#12363;&#12425;&#21462;&#24471;&#12377;&#12427;&#12398;&#12391;&#12289;
		&#19968;&#24847;&#21046;&#32004;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;duplicateErrorMessage&#12289;
		&#22806;&#37096;&#12461;&#12540;&#21046;&#32004;&#29992;&#21517;&#21462;&#24471;&#29992;&#12398;&#27491;&#35215;&#34920;&#29694;&#12434;foreignKeyErrorMessage&#12395;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
	--&gt;
	&lt;!--
	&lt;Resource name=&quot;jdbc/dfdb&quot; auth=&quot;Container&quot;
		type=&quot;javax.sql.DataSource&quot; driverClassName=&quot;oracle.jdbc.OracleDriver&quot;
		url=&quot;jdbc:oracle:thin:@192.168.56.102:1521:xe&quot;
		username=&quot;dfuser&quot; password=&quot;password&quot;/&gt;
	&lt;Environment name=&quot;duplicateErrorMessage&quot; value=&quot;constraint \(.+?\.(.+?)\) violated&quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	&lt;Environment name=&quot;foreignKeyErrorMessage&quot; value=&quot;constraint \(.+?\.(.+?)\) violated &quot; type=&quot;java.lang.String&quot; override=&quot;false&quot;/&gt;
	--&gt;
&lt;/Context&gt;
			</pre>
		</div>
		<p>
			デフォルト設定ではApache derbyの組み込みドライバの設定が有効になっており、
			PostgreSQL,MySQL(MariaDB),Oracleの設定例はコメントで記述されています。
			接続するデータベースに対応する接続設定を有効にしてください。
		</p>
		<p>
			Apache derbyのJDBCドライバは制約違反発生時の制約名称を取得するAPIを持っているため、追加設定は必要ありません。
			しかし、その他のJDBCドライバにはそのようなAPIがないため、エラーメッセージから制約名を取得するようになっています。
			そのため、duplicateErrorMessageに一意制約時のエラーメッセージのパターン、
			foreignKeyErrorMessageに外部制約違反時のエラーメッセージのパターンを記述する必要があります。
			このメッセージはOSの言語設定やDBサーバのバージョンによって異なる可能性があるため、
			制約名が取得できない場合は適切に変更する必要があります。
		</p>
		<h3>web.xmlの設定</h3>
		<p>
			context.xmlに記述したJNDIデータソースの名称は"jdbc/dfdb"となっています。
			これを変更した場合、WebContent/WEB-INF/web.xmlの以下の部分を修正する必要があります。
		</p>
		<div class="filecaption">context.xmlの内容</div>
		<div class="wrappre">
			<pre>
	&lt;!--
	JNDI&#12487;&#12540;&#12479;&#12477;&#12540;&#12473;&#12398;lookup&#12395;&#12399;jndi-prefix&#12392;data-source&#12434;&#32080;&#21512;&#12375;&#12383;&#25991;&#23383;&#21015;&#12391;&#34892;&#12356;&#12414;&#12377;&#12290;
	WebLogic&#12391;&#23455;&#34892;&#12377;&#12427;&#22580;&#21512;&#12399;jndi-prefix&#12395;&#12399;&#31354;&#30333;&#25991;&#23383;&#12434;&#25351;&#23450;&#12375;&#12390;&#12367;&#12384;&#12373;&#12356;&#12290;
	 --&gt;
	&lt;!-- JNDI&#12487;&#12540;&#12479;&#12477;&#12540;&#12473;&#12398;&#21069;&#12395;&#12388;&#12369;&#12427;&#25991;&#23383;&#21015; --&gt;
	&lt;context-param&gt;
		&lt;param-name&gt;jndi-prefix&lt;/param-name&gt;
		&lt;param-value&gt;java:/comp/env/&lt;/param-value&gt;
	&lt;/context-param&gt;
	&lt;!-- &#20351;&#29992;&#12377;&#12427;JNDI&#12487;&#12540;&#12479;&#12477;&#12540;&#12473;&#12434;&#25351;&#23450;&#12377;&#12427; --&gt;
	&lt;context-param&gt;
		&lt;param-name&gt;data-source&lt;/param-name&gt;
		&lt;param-value&gt;jdbc/dfdb&lt;/param-value&gt;
	&lt;/context-param&gt;
			</pre>
		</div>
		<h2>Tableクラス</h2>
		<h3>ツールで生成されたTableクラスの構造</h3>
		<p>
			開発ツールで作成されたテーブルクラスを以下に示します。
		</p>
		<div class="filecaption">開発ツールで作成したテーブルクラス</div>
		<div class="wrappre">
			<pre>
package sample.dao;

import java.util.Map;
import dataforms.dao.Table;
import sample.field.SampleIdField;
import sample.field.SampleTextField;
import sample.field.SampleNumericField;
import sample.field.SampleDateField;
import sample.field.SampleSelectField;


/**
 * &#12469;&#12531;&#12503;&#12523;&#12486;&#12540;&#12502;&#12523;&#12463;&#12521;&#12473;&#12290;
 *
 */
public class SampleTable extends Table {
	/**
	 * &#12467;&#12531;&#12473;&#12488;&#12521;&#12463;&#12479;&#12290;
	 */
	public SampleTable() {
		this.setAutoIncrementId(true);
		this.setComment(&quot;&#12469;&#12531;&#12503;&#12523;&#12486;&#12540;&#12502;&#12523;&quot;);
		this.addPkField(new SampleIdField()); //&#12524;&#12467;&#12540;&#12489;ID
		this.addField(new SampleTextField()); //&#12486;&#12461;&#12473;&#12488;
		this.addField(new SampleNumericField()); //&#25968;&#20516;
		this.addField(new SampleDateField()); //&#26085;&#20184;
		this.addField(new SampleSelectField()); //&#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;
		this.addUpdateInfoFields();
	}

	@Override
	public String getJoinCondition(final Table joinTable, final String alias) {
		SampleTableRelation r = new SampleTableRelation(this);
		return r.getJoinCondition(joinTable, alias);
	}

	/**
	 * Entity&#25805;&#20316;&#12463;&#12521;&#12473;&#12391;&#12377;&#12290;
	 */
	public static class Entity extends dataforms.dao.Entity {
		/** &#12524;&#12467;&#12540;&#12489;ID&#12398;&#12501;&#12451;&#12540;&#12523;&#12489;ID&#12290; */
		public static final String ID_SAMPLE_ID = &quot;sampleId&quot;;
		/** &#12486;&#12461;&#12473;&#12488;&#12398;&#12501;&#12451;&#12540;&#12523;&#12489;ID&#12290; */
		public static final String ID_SAMPLE_TEXT = &quot;sampleText&quot;;
		/** &#25968;&#20516;&#12398;&#12501;&#12451;&#12540;&#12523;&#12489;ID&#12290; */
		public static final String ID_SAMPLE_NUMERIC = &quot;sampleNumeric&quot;;
		/** &#26085;&#20184;&#12398;&#12501;&#12451;&#12540;&#12523;&#12489;ID&#12290; */
		public static final String ID_SAMPLE_DATE = &quot;sampleDate&quot;;
		/** &#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;&#12398;&#12501;&#12451;&#12540;&#12523;&#12489;ID&#12290; */
		public static final String ID_SAMPLE_SELECT = &quot;sampleSelect&quot;;

		/**
		 * &#12467;&#12531;&#12473;&#12488;&#12521;&#12463;&#12479;&#12290;
		 */
		public Entity() {

		}
		/**
		 * &#12467;&#12531;&#12473;&#12488;&#12521;&#12463;&#12479;&#12290;
		 * @param map &#25805;&#20316;&#23550;&#35937;&#12510;&#12483;&#12503;&#12290;
		 */
		public Entity(final Map&lt;String, Object&gt; map) {
			super(map);
		}
		/**
		 * &#12524;&#12467;&#12540;&#12489;ID&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
		 * @return &#12524;&#12467;&#12540;&#12489;ID&#12290;
		 */
		public java.lang.Long getSampleId() {
			return (java.lang.Long) this.getMap().get(Entity.ID_SAMPLE_ID);
		}

		/**
		 * &#12524;&#12467;&#12540;&#12489;ID&#12434;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
		 * @param sampleId &#12524;&#12467;&#12540;&#12489;ID&#12290;
		 */
		public void setSampleId(final java.lang.Long sampleId) {
			this.getMap().put(Entity.ID_SAMPLE_ID, sampleId);
		}

		/**
		 * &#12486;&#12461;&#12473;&#12488;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
		 * @return &#12486;&#12461;&#12473;&#12488;&#12290;
		 */
		public java.lang.String getSampleText() {
			return (java.lang.String) this.getMap().get(Entity.ID_SAMPLE_TEXT);
		}

		/**
		 * &#12486;&#12461;&#12473;&#12488;&#12434;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
		 * @param sampleText &#12486;&#12461;&#12473;&#12488;&#12290;
		 */
		public void setSampleText(final java.lang.String sampleText) {
			this.getMap().put(Entity.ID_SAMPLE_TEXT, sampleText);
		}

		/**
		 * &#25968;&#20516;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
		 * @return &#25968;&#20516;&#12290;
		 */
		public java.math.BigDecimal getSampleNumeric() {
			return (java.math.BigDecimal) this.getMap().get(Entity.ID_SAMPLE_NUMERIC);
		}

		/**
		 * &#25968;&#20516;&#12434;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
		 * @param sampleNumeric &#25968;&#20516;&#12290;
		 */
		public void setSampleNumeric(final java.math.BigDecimal sampleNumeric) {
			this.getMap().put(Entity.ID_SAMPLE_NUMERIC, sampleNumeric);
		}

		/**
		 * &#26085;&#20184;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
		 * @return &#26085;&#20184;&#12290;
		 */
		public java.sql.Date getSampleDate() {
			return (java.sql.Date) this.getMap().get(Entity.ID_SAMPLE_DATE);
		}

		/**
		 * &#26085;&#20184;&#12434;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
		 * @param sampleDate &#26085;&#20184;&#12290;
		 */
		public void setSampleDate(final java.sql.Date sampleDate) {
			this.getMap().put(Entity.ID_SAMPLE_DATE, sampleDate);
		}

		/**
		 * &#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
		 * @return &#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;&#12290;
		 */
		public java.lang.String getSampleSelect() {
			return (java.lang.String) this.getMap().get(Entity.ID_SAMPLE_SELECT);
		}

		/**
		 * &#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;&#12434;&#35373;&#23450;&#12375;&#12414;&#12377;&#12290;
		 * @param sampleSelect &#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;&#12290;
		 */
		public void setSampleSelect(final java.lang.String sampleSelect) {
			this.getMap().put(Entity.ID_SAMPLE_SELECT, sampleSelect);
		}


	}
	/**
	 * &#12524;&#12467;&#12540;&#12489;ID&#12501;&#12451;&#12540;&#12523;&#12489;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
	 * @return &#12524;&#12467;&#12540;&#12489;ID&#12501;&#12451;&#12540;&#12523;&#12489;&#12290;
	 */
	public SampleIdField getSampleIdField() {
		return (SampleIdField) this.getField(Entity.ID_SAMPLE_ID);
	}

	/**
	 * &#12486;&#12461;&#12473;&#12488;&#12501;&#12451;&#12540;&#12523;&#12489;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
	 * @return &#12486;&#12461;&#12473;&#12488;&#12501;&#12451;&#12540;&#12523;&#12489;&#12290;
	 */
	public SampleTextField getSampleTextField() {
		return (SampleTextField) this.getField(Entity.ID_SAMPLE_TEXT);
	}

	/**
	 * &#25968;&#20516;&#12501;&#12451;&#12540;&#12523;&#12489;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
	 * @return &#25968;&#20516;&#12501;&#12451;&#12540;&#12523;&#12489;&#12290;
	 */
	public SampleNumericField getSampleNumericField() {
		return (SampleNumericField) this.getField(Entity.ID_SAMPLE_NUMERIC);
	}

	/**
	 * &#26085;&#20184;&#12501;&#12451;&#12540;&#12523;&#12489;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
	 * @return &#26085;&#20184;&#12501;&#12451;&#12540;&#12523;&#12489;&#12290;
	 */
	public SampleDateField getSampleDateField() {
		return (SampleDateField) this.getField(Entity.ID_SAMPLE_DATE);
	}

	/**
	 * &#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;&#12501;&#12451;&#12540;&#12523;&#12489;&#12434;&#21462;&#24471;&#12375;&#12414;&#12377;&#12290;
	 * @return &#12469;&#12531;&#12503;&#12523;&#36984;&#25246;&#32930;&#12501;&#12451;&#12540;&#12523;&#12489;&#12290;
	 */
	public SampleSelectField getSampleSelectField() {
		return (SampleSelectField) this.getField(Entity.ID_SAMPLE_SELECT);
	}
}

			</pre>
		</div>
		<p>
			テーブルクラスのコンストラクタで、テーブルの構想を定義しています。
			基本的にdataforms2.jarではRecordIdFieldから派生したクラスをaddPkFieldメソッドで主キーとして設定します。
			主キー自動生成を設定するとthis.setAutoIncrementId(true);というコードが生成され、
			レコード追加する際にシーケンス等を使用して自動的に主キーが生成されます。
			通常のフィールドはaddFieldメソッドを使用してフィールドクラスを追加します。
		</p>
		<p>
			テーブルクラスには必ずEntityクラスが定義されています。
			Daoクラスでテーブルのレコードデータの入れ物としてはMap&lt;String, Object&gt;を使用しています。
			このEntityクラスはこのMapオブジェクトを操作するため物です。
			Entityクラスにはテーブルに配置されたフィールド文のゲッター、セッターが定義されています。
			登録するデータを作成したり、読み込んだーデータを取得する際に使用します。
			また、EntityクラスにはフィールドIDの定数が定義されています。
		</p>
		<p>
			テーブルにはそのテーブルに配置されたフィールドのインスタンスを取得するメソッドも生成されています。
			以下のコードではtextField1とtextField2は同じフィールドのインスタンスになります。
		</p>
		<div class="filecaption">テーブルからフィールドの取得</div>
		<div class="wrappre">
			<pre>
SampleTable table = new SampleTable();
SampleTextField textField1 = table.getSampleTextField();
SampleTextField textField2 = (SampleTextField) this.getField(Entity.ID_SAMPLE_TEXT);
			</pre>
		</div>
		<p>
			getJoinConditionメソッドは他のテーブルとの結合条件を生成するためのメソッドです。
			この結合条件の生成処理はXxxTableRelationクラスで行っており、
			テーブルの結合条件はXxxTableRelationクラスに記述する必要があります。
			XxxTableRelationクラスはXxxTableクラスが作成されるタイミングで作成されます。
			その後開発ツールでXxxTableクラスのソースを更新するときには更新されることはありません。
		</p>
		<p>
			以下に開発ツールで生成したSampleTableRelation.javaを示します。
			このクラスではSampleTableにHogeTableをjoinした場合の条件式を記述します。
		</p>
		<p>
			joinの際の条件式の設定は外部キーを定義する方法と、
			外部キーは設定せずに条件式のみ設定する方法があります。
		</p>
		<p>
			static {}でForeignKeyのインスタンスを追加することにより、外部キーを追加することができます。
			外部キーを追加することにより自動的にjoinの際の条件式も生成されるようになります。
			外部キーを追加した後、テーブル管理で該当テープを表示すると、構造の差分有と表示されます。
			テーブル構造の更新を行うと、データベースに外部キーを作成することができます。
		</p>
		<p>
			外部キーを使用しない結合条件を生成したい場合、getJoinConditionメソッドに条件作成処理を記述します。
			以下の例ではHogeTableとの結合条件を生成する処理がコメントアウトされた状態で入っています。
			この記述を参考に結合条件式の生成処理を作成してください。
		</p>
		<div class="filecaption">テーブル関連定義クラス</div>
		<div class="wrappre">
			<pre>
package sample.dao;

import java.util.ArrayList;
import java.util.List;

import dataforms.dao.ForeignKey;
import dataforms.dao.Table;
import dataforms.dao.TableRelation;

/**
 * SampleTableの関係を定義するクラスです。
 *
 */
public class SampleTableRelation extends TableRelation {

	/**
	 * 外部キーリスト。
	 */
	private static List<ForeignKey> foreignKeyList = null;

	/**
	 * 外部キーリストの定義。
	 * <pre>
	 * この初期化処理で外部キーを定義することにより、自動的に外部キーが設定されます。
	 * </pre>
	 */
	static {
		foreignKeyList = new ArrayList<ForeignKey>();
		/*
		 * 以下の定義を有効にすると外部キーHogeTableに対する外部キーを設定します。
		 * この設定だけでHogeTableとの結合条件も生成されるようになります。
		 */
		// foreignKeyList.add(new ForeignKey("fkSampleTable01", SampleTable.Entity.ID_HOGE_ID, HogeTable.class));
	}

	@Override
	public List<ForeignKey> getForeignKeyList() {
		return foreignKeyList;
	}

	/**
	 * コンストラクタ。
	 * @param table 対象テーブル。
	 */
	public SampleTableRelation(final Table table) {
		super(table);
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public String getJoinCondition(final Table joinTable, final String alias) {
		/*
		 * 外部キーを設定せずに結合条件を生成する場合は以下を有効にします。
		 */
/*
		if (joinTable instanceof HogeTable) {
			return this.getTable().getLinkFieldCondition(HogeTable.Entity.ID_HOGE_ID, joinTable, alias);
		}
*/
		return super.getJoinCondition(joinTable, alias);
	}
}
			</pre>
		</div>
		<h2>TableクラスとDaoクラス</h2>
		<p>

		</p>
		<h2>問合せクラス</h2>
		<h2>問合せクラスとDaoクラス</h2>
		<h2>QuerySetDaoクラス解説</h2>
	</body>
</html>