<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>設定</title>
		<link type="text/css" href="../css/document.css" rel="stylesheet" />
	</head>
	<body>
		<h1><span>9.</span>設定</h1>
		<h2>WEB-INF/web.xml</h2>
		<p>
			dataforms2.jarの各種設定はWEB-INF/web.xmlにまとまっています。
			各種設定項目のコメントを参照し、適切に設定してください。
		</p>
		<h2>context.xml</h2>
		<p>
			dfblank_xxx.warにはMETA-INF/context.xmlが存在しています。
			このファイルにはメールセッションの設定例とデータベースへの接続設定例が記述されています。
		</p>
		<h3>メール設定</h3>
		<p>
			一般公開し外部からのユーザ登録を許可するシステムの場合、メール送信機能を使用します。
			このような場合有効なSMTPサーバの情報を設定しください。
		</p>
		<h3>データベース設定</h3>
		<p>
			データベースの接続設定は組み込みApache Derbyの接続設定例が有効になっています。
			このままApache Derbyを使用する場合、データベースファイルのパスを適切に変更して使用してください。
		</p>
		<p>
			PostgreSQL等のデータベースを使用する場合、Apache Derbyの接続設定をコメントアウトし、
			PostgreSQL等の接続設定を有効にして適切に変更してください。
			この設定変更だけで、データベースを切り替えることができます。
		</p>
		<p>
			Apache Derby以外のデータベースの場合duplicateErrorMessageとforeignKeyErrorMessageという変数が定義されています。
			Apache DerbyのJDBCドライバには一意制約違反や外部キー制約違反等の例外が発生した場合、
			その制約名を取得するAPIが存在しています。
			しかし、その他のデータベースの場合そのようなAPIが存在しないため、
			例外のメッセージから制約の名称を取得するようになっています。
			このようなメッセージはOSの言語設定やデータベースのバージョンによって異なる可能性があるため、
			使用する環境に応じて適切に修正してください。
		</p>
		<h3>context.xmlの場所</h3>
		<p>
			META-INF/context.xmlはWebアプリケーション中の設定ファイルとなります。
			開発時やrunwarでスタンドアロン運用する場合はこのままで良いのですが、
			別途Tomcatを運用するサーバを用意する場合はTomcatのconf/context.xmlにこれらの設定を移動します。
			開発環境のTomcatにはテスト用のデータベース接続設定をおこない、
			運用環境のTomcatには本番用のデータベース接続設定を行っておきます。
			こうしておくと、開発環境で作成したwarファイルを運用環境の/webapps/にコピーするだけでデプロイすることができます。
		</p>
	</body>
</html>